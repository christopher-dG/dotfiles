#!/usr/bin/env bash

dir="$HOME/.local/share/audio"
mkdir -p "$dir"

case "$1" in
  now-playing)
    status="$(baton status 2> /dev/null)"
    if [[ "$?" -ne 0 ]]; then
      echo
      exit
    fi
    [[ "$status" = "Couldn't"* ]] && echo && exit
    state="$(echo "$status" | grep State: | cut -d' ' -f2)"
    title="$(echo "$status" | grep Track: | cut -d' ' -f2-)"
    artist="$(echo "$status" | grep Artist: | cut -d' ' -f2-)"
    if [[ "$state" = "Paused" ]]; then
      paused=" (p)"
    fi
    echo "$artist - $title$paused"
    ;;
  pause|next|prev)
    baton "$1"
    ;;
  toggle-output)
    sink="$(pacmd list-sinks | grep index: | grep -v '*' | cut -d: -f2)"
    pacmd set-default-sink "$sink"
    ;;
esac
